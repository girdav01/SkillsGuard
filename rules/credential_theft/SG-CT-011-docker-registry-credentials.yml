id: SG-CT-011
name: Docker Registry Credentials
description: >
  Detects attempts to access Docker registry credentials from the
  Docker config file, environment variables, or credential helpers.
  These credentials provide access to push and pull container images
  from private registries.
severity: high
category: credential_theft
owasp_llm: [LLM06]
mitre_attack: [T1552.001]
target: ANY
engine: REGEX
pattern:
  any:
    - "(?i)(cat|read|open|get|less|type|head|tail|print)\\s+.{0,20}(~|\\.)/?\\.docker/(config\\.json|daemon\\.json)"
    - "(?i)(cp|copy|mv|scp|rsync|send|upload|post|transmit)\\s+.{0,30}\\.docker/config\\.json"
    - "(?i)\\$\\{?(DOCKER_USERNAME|DOCKER_PASSWORD|DOCKER_AUTH_TOKEN|DOCKER_REGISTRY_TOKEN|DOCKER_CONFIG|REGISTRY_AUTH)\\}?"
    - "(?i)(docker|podman)\\s+login\\s+.{0,30}(-p\\s+|-u\\s+|--password[= ]|--username[= ])"
    - "(?i)[\"']auths[\"']\\s*:\\s*\\{\\s*[\"']https?://[^\"']+[\"']\\s*:\\s*\\{\\s*[\"']auth[\"']"
    - "(?i)(steal|extract|exfiltrate|harvest|grab|dump)\\s+.{0,20}(docker|container|registry)\\s*(credential|password|token|auth)"
    - "(?i)base64\\s+(decode|--decode|-d)\\s+.{0,30}\\.docker"
    - "(?i)(docker|crane|skopeo)\\s+(config|auth|credential)\\s+(get|list|show|dump)"
false_positive_notes: >
  Docker workflow skills may reference registry authentication
  for legitimate CI/CD purposes. Verify whether the skill
  configures new auth vs. extracting existing credentials.
remediation: >
  Remove references to reading Docker registry credentials.
  Use credential helpers, CI/CD secret injection, or managed
  identity authentication for registry access.
references:
  - https://docs.docker.com/engine/reference/commandline/login/
  - https://attack.mitre.org/techniques/T1552/001/

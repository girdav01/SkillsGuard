id: SG-CT-015
name: Password File Access
description: >
  Detects attempts to access system password files, shadow files,
  password managers, and other password storage mechanisms. These
  files contain user authentication credentials that provide
  unauthorized access to systems and services.
severity: critical
category: credential_theft
owasp_llm: [LLM06]
mitre_attack: [T1003.008, T1555]
target: ANY
engine: REGEX
pattern:
  any:
    - "(?i)(cat|read|open|get|less|type|head|tail|print|more|strings)\\s+.{0,10}/etc/(passwd|shadow|master\\.passwd|security/passwd)"
    - "(?i)(cat|read|open|get)\\s+.{0,10}/etc/(group|gshadow|sudoers)"
    - "(?i)(cp|copy|scp|rsync|send|upload|post|transmit)\\s+.{0,20}/etc/(passwd|shadow)"
    - "(?i)(cat|read|open|get|find|ls)\\s+.{0,30}(passwords?\\.txt|passwords?\\.csv|passwords?\\.json|passwords?\\.xml|passwords?\\.db|passwords?\\.kdbx?)"
    - "(?i)(unshadow|john|hashcat|crack|brute[_-]?force)\\s+.{0,30}(passwd|shadow|hash|password)"
    - "(?i)(cat|read|open|get|dump)\\s+.{0,20}(SAM|SYSTEM|NTDS\\.dit|SECURITY)"
    - "(?i)(mimikatz|lsadump|sekurlsa|kerberoast|asreproast)"
    - "(?i)(steal|extract|exfiltrate|harvest|grab|dump|crack)\\s+.{0,20}(password|passwd|hash|ntlm|credential)"
    - "(?i)(1password|lastpass|bitwarden|keepass|dashlane)\\s*.{0,20}(vault|database|backup|export|dump|extract)"
    - "(?i)(cat|read|open|get)\\s+.{0,30}\\.(kdbx?|agilekeychain|opvault)\\b"
false_positive_notes: >
  Security auditing or system administration skills may reference
  password files for legitimate purposes. Verify the intent:
  user management vs. credential extraction.
remediation: >
  Remove all references to reading password files or credential
  stores. Skills should never directly access system authentication
  databases or password manager vaults.
references:
  - https://attack.mitre.org/techniques/T1003/008/
  - https://attack.mitre.org/techniques/T1555/

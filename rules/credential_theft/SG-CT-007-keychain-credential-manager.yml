id: SG-CT-007
name: Keychain and Credential Manager Access
description: >
  Detects attempts to access system-level credential managers
  including macOS Keychain, Windows Credential Manager, GNOME
  Keyring, and KDE Wallet. These stores contain passwords, tokens,
  and certificates for various applications and services.
severity: critical
category: credential_theft
owasp_llm: [LLM06]
mitre_attack: [T1555, T1555.001]
target: ANY
engine: REGEX
pattern:
  any:
    - "(?i)security\\s+(find|dump|delete|export)-(generic|internet)-password"
    - "(?i)security\\s+dump-keychain"
    - "(?i)(keychain|Keychain\\.app)\\s*.{0,20}(dump|export|extract|read|list|search)"
    - "(?i)(cmdkey|vaultcmd|CredentialManager|Windows\\s+Vault)\\s*.{0,20}(list|dump|export|extract|/list)"
    - "(?i)cmdkey\\s+/list"
    - "(?i)(gnome-keyring|secret-tool|seahorse)\\s+(lookup|search|dump|store)"
    - "(?i)(kwallet|kwalletcli|kwalletmanager)\\s+(query|list|dump|export)"
    - "(?i)(steal|extract|exfiltrate|harvest|grab|dump)\\s+.{0,20}(keychain|credential\\s+manager|keyring|kwallet)"
    - "(?i)dbus-send\\s+.{0,40}org\\.freedesktop\\.secrets"
    - "(?i)(import\\s+)?keyring\\.(get_password|get_credential|set_password)"
false_positive_notes: >
  Credential management skills may interact with keychains for
  legitimate purposes. Verify whether the skill stores new
  credentials vs. exfiltrating existing ones.
remediation: >
  Remove references to reading from system credential stores.
  If credential storage is needed, use the appropriate credential
  management API with explicit user authorization.
references:
  - https://attack.mitre.org/techniques/T1555/001/
  - https://support.apple.com/guide/security/keychain-data-protection-secb0694df1a/web

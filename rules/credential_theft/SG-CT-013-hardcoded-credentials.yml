id: SG-CT-013
name: Hardcoded Credentials in Script
description: >
  Detects hardcoded passwords, API keys, tokens, and other secrets
  directly embedded in script files. Hardcoded credentials are a
  common security vulnerability that exposes secrets in version
  control and to anyone with file access.
severity: high
category: credential_theft
owasp_llm: [LLM06]
mitre_attack: [T1552.001]
target: SCRIPT
engine: REGEX
pattern:
  any:
    - "(?i)(password|passwd|pwd|pass)\\s*[=:]\\s*[\"'][^\"']{8,}[\"']"
    - "(?i)(api[_-]?key|apikey|api[_-]?secret)\\s*[=:]\\s*[\"'][^\"']{10,}[\"']"
    - "(?i)(secret[_-]?key|secret)\\s*[=:]\\s*[\"'][^\"']{10,}[\"']"
    - "(?i)(auth[_-]?token|access[_-]?token|bearer[_-]?token|token)\\s*[=:]\\s*[\"'][^\"']{10,}[\"']"
    - "(?i)(private[_-]?key)\\s*[=:]\\s*[\"'][^\"']{20,}[\"']"
    - "(?i)Authorization\\s*[=:]\\s*[\"']Bearer\\s+[A-Za-z0-9\\-_.~+/]+=*[\"']"
    - "(?i)Basic\\s+[A-Za-z0-9+/=]{20,}"
    - "(?i)(sk|pk|rk)[-_](live|test|prod)[-_][A-Za-z0-9]{20,}"
    - "(?i)eyJ[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}"
    - "(?i)(xox[bpas]-[A-Za-z0-9\\-]{10,})"
false_positive_notes: >
  Test files or example code may contain placeholder credentials.
  Check whether the values appear to be real credentials vs.
  obvious placeholders like "your-api-key-here" or "changeme".
remediation: >
  Remove all hardcoded credentials from scripts. Use environment
  variables, secret management services, or configuration files
  excluded from version control (.gitignore) to manage secrets.
references:
  - https://cwe.mitre.org/data/definitions/798.html
  - https://cwe.mitre.org/data/definitions/259.html

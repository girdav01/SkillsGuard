id: SG-CT-005
name: Git Credential Access
description: >
  Detects attempts to access Git credentials, tokens, and
  configuration that may contain authentication information.
  This includes .gitconfig, credential helpers, GitHub/GitLab
  tokens, and Git credential storage files.
severity: high
category: credential_theft
owasp_llm: [LLM06]
mitre_attack: [T1552.001]
target: ANY
engine: REGEX
pattern:
  any:
    - "(?i)(cat|read|open|get|less|type|head|tail|print)\\s+.{0,20}(\\.gitconfig|\\.git-credentials|\\.git/config)"
    - "(?i)(cat|read|open|get)\\s+.{0,20}~/.config/git/credentials"
    - "(?i)git\\s+config\\s+.{0,20}(credential|user\\.password|oauth|token)"
    - "(?i)git\\s+credential\\s+(fill|approve|reject|get)"
    - "(?i)\\$\\{?(GITHUB_TOKEN|GITHUB_PAT|GH_TOKEN|GITLAB_TOKEN|GITLAB_PAT|GIT_ASKPASS|GIT_PASSWORD|BITBUCKET_TOKEN)\\}?"
    - "(?i)(ghp|gho|ghu|ghs|ghr)_[A-Za-z0-9_]{36,}"
    - "(?i)glpat-[A-Za-z0-9\\-_]{20,}"
    - "(?i)(steal|extract|exfiltrate|harvest|grab|dump)\\s+.{0,20}(git|github|gitlab)\\s*(credential|token|secret|auth)"
    - "(?i)(send|post|upload|transmit|curl|wget)\\s+.{0,40}(git[_-]?credentials|github[_-]?token|gitlab[_-]?token)"
false_positive_notes: >
  Git workflow skills may reference credential configuration for
  setup purposes. Distinguish between configuring Git authentication
  and extracting existing credentials.
remediation: >
  Remove references to reading Git credential files or tokens.
  Use Git credential helpers or SSH keys managed by the system's
  credential manager instead of accessing credentials directly.
references:
  - https://git-scm.com/docs/gitcredentials
  - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens

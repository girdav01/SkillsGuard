id: SG-MCP-010
name: Excessive Tool Permissions
description: >
  Detects overly permissive MCP tool configurations that grant broader
  access than necessary. This includes wildcard permissions, unrestricted
  file system access, full shell access, admin-level capabilities, and
  tools that declare access to all resources without scoping. Excessive
  permissions enable attackers to leverage a compromised tool for
  broader system access.
severity: high
category: mcp_specific
owasp_llm: [LLM06]
mitre_attack: [T1078.004, T1548]
target: ANY
engine: REGEX
pattern:
  any:
    - "(?i)(permission|scope|access|allow|grant|capability|privilege)\\s*[=:]\\s*[\"']?\\s*(\\*|all|full|admin|root|superuser|unrestricted|unlimited|any)[\"']?"
    - "(?i)(read|write|execute|delete|modify)\\s*[=:]\\s*[\"']?\\s*(\\*|all|any|/\\*|/\\*\\*|\\.\\.)[\"']?"
    - "(?i)(file[_\\-\\s]?system|filesystem|fs)[_\\-\\s]?(access|permission|scope)\\s*[=:]\\s*[\"']?\\s*(/|\\*|all|full|unrestricted)"
    - "(?i)(allowed[_\\-]?paths|allowedPaths|path[_\\-]?scope|pathScope)\\s*[=:]\\s*[\"']?\\s*(/|\\*|\\.\\.)[\"']?"
    - "(?i)(network|internet|web|http)[_\\-\\s]?(access|permission|scope)\\s*[=:]\\s*[\"']?\\s*(\\*|all|any|unrestricted|unlimited)"
    - "(?i)(shell|bash|command|exec)[_\\-\\s]?(access|permission|enable|allow)\\s*[=:]\\s*[\"']?\\s*(true|True|TRUE|1|yes|all|unrestricted)"
    - "(?i)(sudo|root|admin|administrator|superuser)\\s*[=:]\\s*[\"']?(true|True|TRUE|1|yes|enabled|required)"
    - "(?i)(no[_\\-\\s]?sandbox|disable[_\\-\\s]?sandbox|sandbox[_\\-\\s]?mode)\\s*[=:]\\s*[\"']?(false|False|FALSE|0|no|off|disabled|none)"
    - "(?i)(allow[_\\-\\s]?all[_\\-\\s]?origins|cors[_\\-\\s]?origin)\\s*[=:]\\s*[\"']?\\s*\\*[\"']?"
    - "(?i)(max[_\\-\\s]?tokens|rate[_\\-\\s]?limit|max[_\\-\\s]?requests)\\s*[=:]\\s*[\"']?(unlimited|infinite|Infinity|999999|0)[\"']?"
false_positive_notes: >
  Development and testing environments may intentionally use broad
  permissions for convenience. Some tools may genuinely require wide
  access (e.g., a file manager tool). Evaluate whether the breadth
  of permissions is justified by the tool's documented purpose.
remediation: >
  Apply the principle of least privilege to all MCP tool configurations.
  Scope file system access to specific directories, limit network access
  to specific domains, disable shell access unless absolutely necessary,
  and never run tools with root/admin privileges. Use sandboxing to
  enforce permission boundaries.
references:
  - https://genai.owasp.org/llmrisk/llm06-excessive-agency/
  - https://cwe.mitre.org/data/definitions/250.html
  - https://attack.mitre.org/techniques/T1548/
enabled: true
